<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard de Inmunidad Digital: LATAM & Espa√±a | {{WEEK_DATE}}</title>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
background-color: #091F2C;
color: #ffffff;
line-height: 1.6;
padding-bottom: 60px;
}

.container {
max-width: 1200px;
margin: 0 auto;
padding: 20px;
}

/* Executive Summary Card - Enhanced for DII 4.0 */
.executive-summary {
background: linear-gradient(135deg, rgba(180, 181, 223, 0.2), rgba(26, 43, 61, 0.6));
padding: 30px;
border-radius: 12px;
margin-bottom: 30px;
border: 2px solid rgba(180, 181, 223, 0.3);
}

.executive-summary h2 {
font-size: 24px;
color: #B4B5DF;
margin-bottom: 20px;
}

.summary-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 20px;
}

.summary-item {
text-align: center;
}

.summary-number {
font-size: 42px;
font-weight: 700;
margin-bottom: 5px;
}

.summary-label {
font-size: 14px;
color: #A6BBC8;
}

.summary-action {
background: rgba(180, 181, 223, 0.2);
padding: 15px 20px;
border-radius: 8px;
margin-top: 20px;
font-size: 16px;
text-align: center;
}

/* DII Components Display */
.dii-analysis {
background: rgba(26, 43, 61, 0.5);
padding: 25px;
border-radius: 12px;
margin-bottom: 30px;
border: 1px solid rgba(180, 181, 223, 0.3);
}

.dii-components {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 15px;
margin-top: 20px;
}

.dii-component {
text-align: center;
background: rgba(180, 181, 223, 0.1);
padding: 15px;
border-radius: 8px;
}

.dii-component-value {
font-size: 24px;
font-weight: 600;
color: #B4B5DF;
}

.dii-component-label {
font-size: 12px;
color: #A6BBC8;
margin-top: 5px;
}

.dii-formula {
text-align: center;
margin-top: 20px;
padding: 15px;
background: rgba(0, 0, 0, 0.2);
border-radius: 8px;
font-family: 'Courier New', monospace;
font-size: 14px;
color: #B4B5DF;
}

/* Framework Context Box - Updated for DII 4.0 */
.framework-context {
background: rgba(180, 181, 223, 0.1);
padding: 25px;
border-radius: 12px;
margin-bottom: 30px;
border: 1px solid rgba(180, 181, 223, 0.3);
text-align: center;
}

.framework-context h4 {
font-size: 20px;
color: #B4B5DF;
margin-bottom: 15px;
font-weight: 500;
}

.framework-context p {
font-size: 15px;
color: #A6BBC8;
margin-bottom: 8px;
}

.framework-context a {
display: inline-block;
margin-top: 10px;
color: #B4B5DF;
text-decoration: none;
font-size: 16px;
padding: 8px 16px;
background: rgba(180, 181, 223, 0.2);
border-radius: 6px;
transition: all 0.3s;
}

.framework-context a:hover {
background: rgba(180, 181, 223, 0.3);
transform: translateY(-1px);
}

/* Header */
.header {
text-align: center;
padding: 30px;
background: rgba(26, 43, 61, 0.5);
border-radius: 12px;
margin-bottom: 30px;
}

.header h1 {
font-size: 32px;
font-weight: 400;
margin-bottom: 10px;
}

.header-date {
color: #A6BBC8;
font-size: 15px;
}

/* Key Metrics - Enhanced for DII */
.metrics-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
gap: 20px;
margin-bottom: 30px;
}

.metric-card {
background: rgba(26, 43, 61, 0.5);
padding: 25px;
border-radius: 8px;
text-align: center;
border: 1px solid rgba(180, 181, 223, 0.2);
position: relative;
}

.metric-number {
font-size: 36px;
font-weight: 600;
color: #B4B5DF;
display: block;
margin-bottom: 5px;
}

.metric-label {
font-size: 13px;
color: #A6BBC8;
text-transform: uppercase;
}

.metric-context {
font-size: 12px;
color: #7A99AC;
margin-top: 8px;
}

/* DII Interpretation Scale */
.dii-scale {
margin: 20px 0;
padding: 20px;
background: rgba(26, 43, 61, 0.5);
border-radius: 8px;
}

.dii-scale-bar {
height: 40px;
background: linear-gradient(to right, 
  #C10016 0%, 
  #C10016 25%, 
  #FF6B6B 25%, 
  #FF6B6B 50%, 
  #FFB84D 50%, 
  #FFB84D 75%, 
  #4CAF50 75%, 
  #4CAF50 100%);
border-radius: 20px;
position: relative;
margin: 15px 0;
cursor: pointer;
box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
}

.dii-scale-labels {
display: flex;
justify-content: space-between;
font-size: 12px;
color: #A6BBC8;
margin-top: 10px;
}

.dii-maturity-info {
margin-top: 20px;
padding: 15px;
background: rgba(180, 181, 223, 0.1);
border-radius: 8px;
text-align: center;
min-height: 80px;
transition: all 0.3s ease;
}

.dii-maturity-info h4 {
font-size: 16px;
color: #B4B5DF;
margin-bottom: 8px;
}

.dii-maturity-info p {
font-size: 14px;
color: #A6BBC8;
line-height: 1.4;
}

.maturity-fragil {
background: rgba(193, 0, 22, 0.2);
border: 1px solid rgba(193, 0, 22, 0.3);
}

.maturity-robusto {
background: rgba(255, 107, 107, 0.2);
border: 1px solid rgba(255, 107, 107, 0.3);
}

.maturity-resiliente {
background: rgba(255, 184, 77, 0.2);
border: 1px solid rgba(255, 184, 77, 0.3);
}

.maturity-adaptativo {
background: rgba(76, 175, 80, 0.2);
border: 1px solid rgba(76, 175, 80, 0.3);
}

.dii-pointer {
position: absolute;
top: -10px;
width: 4px;
height: 50px;
background: #ffffff;
border-radius: 2px;
box-shadow: 0 2px 4px rgba(0,0,0,0.3);
transition: left 0.3s ease;
}

/* Business Model Badges */
.business-model-badge {
display: inline-block;
padding: 6px 12px;
background: rgba(180, 181, 223, 0.2);
border-radius: 20px;
font-size: 12px;
margin: 2px;
border: 1px solid rgba(180, 181, 223, 0.3);
}

/* Traffic Light Indicator */
.traffic-light {
position: absolute;
top: 10px;
right: 10px;
width: 20px;
height: 20px;
border-radius: 50%;
}

.traffic-light.red { background: #C10016; }
.traffic-light.yellow { background: #FFB84D; }
.traffic-light.green { background: #4CAF50; }

/* Chart Container - Enhanced for Business Models */
.chart-container {
background: rgba(26, 43, 61, 0.5);
padding: 30px;
border-radius: 8px;
margin-bottom: 40px;
}

.chart-title {
text-align: center;
font-size: 24px;
font-weight: 600;
color: #B4B5DF;
margin-bottom: 20px;
}

.chart-wrapper {
position: relative;
width: 100%;
max-width: 800px;
margin: 0 auto;
}

.y-axis-label {
position: absolute;
left: -80px;
top: 50%;
transform: translateY(-50%) rotate(180deg);
writing-mode: vertical-rl;
text-orientation: mixed;
color: #B4B5DF;
font-size: 14px;
font-weight: 600;
}

.scatter-chart {
width: 100%;
height: 500px;
position: relative;
background: rgba(0, 0, 0, 0.1);
border: 1px solid rgba(180, 181, 223, 0.2);
overflow: hidden;
}

.x-axis-label {
text-align: center;
color: #B4B5DF;
font-size: 14px;
font-weight: 600;
margin-top: 20px;
}

.chart-quadrant {
position: absolute;
width: 50%;
height: 50%;
display: flex;
align-items: center;
justify-content: center;
text-align: center;
padding: 20px;
font-size: 13px;
color: #A6BBC8;
z-index: 1;
}

.chart-quadrant-title {
font-size: 16px;
font-weight: 700;
color: #B4B5DF;
margin-bottom: 8px;
}

.chart-point {
position: absolute;
width: 70px;
height: 70px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-weight: 600;
font-size: 11px;
cursor: pointer;
transition: all 0.3s;
box-shadow: 0 4px 15px rgba(0,0,0,0.4), 0 2px 4px rgba(0,0,0,0.2);
text-align: center;
flex-direction: column;
z-index: 10;
line-height: 1.2;
transform: translate(-50%, -50%);
}

.chart-point:hover {
transform: translate(-50%, -50%) scale(1.1);
z-index: 20;
}

.chart-point .dii-value {
font-size: 16px;
font-weight: 700;
}

/* Incident Cards - New for DII 4.0 */
.incidents-section {
margin: 40px 0;
}

.incident-card {
background: rgba(26, 43, 61, 0.5);
padding: 20px;
border-radius: 8px;
margin-bottom: 15px;
border: 1px solid rgba(180, 181, 223, 0.2);
position: relative;
}

.incident-header {
display: flex;
justify-content: space-between;
align-items: flex-start;
margin-bottom: 15px;
}

.incident-header h3 {
font-size: 18px;
color: #B4B5DF;
flex: 1;
margin-right: 10px;
}

.severity-badge {
padding: 4px 12px;
border-radius: 15px;
font-size: 12px;
font-weight: 600;
white-space: nowrap;
}

.severity-badge.critical {
background: #C10016;
color: white;
}

.severity-badge.high {
background: #FF6B6B;
color: white;
}

.severity-badge.medium {
background: #FFB84D;
color: #091F2C;
}

.incident-date {
font-size: 13px;
color: #7A99AC;
margin-bottom: 10px;
}

.incident-metrics {
display: flex;
flex-wrap: wrap;
gap: 15px;
margin-top: 15px;
padding-top: 15px;
border-top: 1px solid rgba(180, 181, 223, 0.1);
}

.incident-metrics span {
font-size: 13px;
color: #A6BBC8;
}

.dii-breakdown {
margin-top: 10px;
padding: 10px;
background: rgba(0, 0, 0, 0.2);
border-radius: 6px;
font-family: 'Courier New', monospace;
font-size: 11px;
color: #7A99AC;
}

/* Threat Grid - Enhanced */
.threat-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
gap: 20px;
margin-bottom: 40px;
}

.threat-card {
background: rgba(26, 43, 61, 0.5);
padding: 20px;
border-radius: 8px;
border: 1px solid rgba(180, 181, 223, 0.2);
}

.threat-header {
display: flex;
align-items: center;
gap: 12px;
margin-bottom: 15px;
padding-bottom: 15px;
border-bottom: 1px solid rgba(180, 181, 223, 0.1);
}

.threat-title {
font-size: 18px;
font-weight: 500;
}

.threat-list {
list-style: none;
}

.threat-list li {
background: rgba(255, 255, 255, 0.03);
padding: 12px;
margin-bottom: 8px;
border-radius: 6px;
}

.threat-name {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 4px;
}

.threat-value {
font-weight: 600;
color: #B4B5DF;
}

/* Actions Grid - Enhanced for Consultative Approach */
.actions-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
gap: 20px;
margin-bottom: 40px;
}

.action-card {
background: rgba(26, 43, 61, 0.6);
padding: 25px;
border-radius: 8px;
border-top: 3px solid #B4B5DF;
}

.action-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
}

.action-title {
font-size: 18px;
color: #B4B5DF;
}

.action-dii-range {
background: rgba(180, 181, 223, 0.2);
padding: 5px 12px;
border-radius: 15px;
font-size: 12px;
color: #B4B5DF;
}

.action-list {
list-style: none;
}

.action-list li {
padding: 10px 0;
font-size: 14px;
color: #ffffff;
padding-left: 20px;
position: relative;
}

.action-list li:before {
content: '‚Üí';
position: absolute;
left: 0;
color: #7A99AC;
}

/* Business Model Distribution */
.model-distribution {
background: rgba(26, 43, 61, 0.5);
padding: 25px;
border-radius: 8px;
margin-bottom: 30px;
}

.model-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 15px;
margin-top: 20px;
}

.model-item {
text-align: center;
padding: 15px;
background: rgba(180, 181, 223, 0.1);
border-radius: 8px;
transition: all 0.3s ease;
}

.model-item-highlight {
border: 2px solid rgba(180, 181, 223, 0.4);
background: rgba(180, 181, 223, 0.2);
transform: scale(1.05);
}

.model-item-empty {
opacity: 0.6;
background: rgba(180, 181, 223, 0.05);
}

.model-count {
font-size: 28px;
font-weight: 600;
color: #B4B5DF;
}

.model-item-empty .model-count {
color: #7A99AC;
}

.model-name {
font-size: 13px;
color: #A6BBC8;
margin-top: 5px;
}

/* Footer */
.footer {
text-align: center;
padding: 40px 20px;
color: #A6BBC8;
}

.footer-quote {
font-size: 18px;
font-style: italic;
color: #B4B5DF;
margin-bottom: 8px;
}

.report-meta {
margin-top: 20px;
padding-top: 15px;
border-top: 1px solid rgba(166, 187, 200, 0.2);
font-size: 13px;
color: #7A8B9A;
}

.report-meta a {
color: #A6BBC8;
text-decoration: none;
transition: color 0.3s;
}

.report-meta a:hover {
color: #B4B5DF;
text-decoration: underline;
}

/* Interactive hover effects */
.metric-card:hover {
transform: translateY(-2px);
border-color: rgba(180, 181, 223, 0.4);
cursor: pointer;
}

.threat-list li:hover {
background: rgba(255, 255, 255, 0.06);
transform: translateX(3px);
cursor: pointer;
}

.action-card:hover {
transform: translateY(-2px);
border-color: rgba(180, 181, 223, 0.4);
}

/* Detail panel for interactions */
.detail-panel {
position: fixed;
bottom: -100%;
left: 0;
right: 0;
background: linear-gradient(to top, #091F2C, rgba(26, 43, 61, 0.95));
padding: 30px;
border-top: 2px solid #B4B5DF;
transition: all 0.3s ease;
z-index: 1000;
max-height: 50vh;
overflow-y: auto;
}

.detail-panel.show {
bottom: 60px;
}

.detail-close {
position: absolute;
top: 15px;
right: 20px;
background: rgba(180, 181, 223, 0.2);
border: none;
color: #B4B5DF;
padding: 8px 16px;
border-radius: 6px;
cursor: pointer;
}

#detailContent {
margin-top: 20px;
}

/* News ticker */
.news-ticker {
background: linear-gradient(90deg, #C10016, #091F2C);
color: white;
padding: 15px;
position: fixed;
bottom: 0;
left: 0;
right: 0;
display: flex;
align-items: center;
justify-content: space-between;
gap: 20px;
z-index: 999;
}

.ticker-content {
flex: 1;
overflow: hidden;
}

.ticker-source {
color: #FFB84D;
font-size: 14px;
}

.ticker-action {
color: #B4B5DF;
cursor: pointer;
text-decoration: underline;
}

/* Tooltip for chart points */
.chart-point::after {
content: attr(data-info);
position: absolute;
bottom: 100%;
left: 50%;
transform: translateX(-50%);
background: rgba(26, 43, 61, 0.95);
color: white;
padding: 8px 12px;
border-radius: 6px;
font-size: 12px;
white-space: nowrap;
opacity: 0;
pointer-events: none;
transition: opacity 0.3s;
margin-bottom: 5px;
border: 1px solid rgba(180, 181, 223, 0.3);
}

.chart-point:hover::after {
opacity: 1;
}

/* Source styling for threat cards */
.threat-source {
font-size: 12px;
color: #FFB84D;
margin-top: 5px;
}

/* Mobile Responsive */
@media (max-width: 768px) {
.container {
padding: 10px;
}
.header h1 {
font-size: 24px;
}
.summary-grid {
grid-template-columns: 1fr;
}
.threat-grid {
grid-template-columns: 1fr;
}
.actions-grid {
grid-template-columns: 1fr;
}
.news-ticker {
font-size: 14px;
padding: 10px;
}
.dii-components {
grid-template-columns: repeat(3, 1fr);
}
.incident-metrics {
font-size: 12px;
}
}
</style>
</head>
<body>
<div class="container">
<!-- Executive Summary Card -->
<div class="executive-summary">
<h2>El Impacto de los Incidentes de Esta Semana en 30 Segundos</h2>
<div class="summary-grid">
<div class="summary-item">
<div class="summary-number" style="color: #FFB84D;">{{DII_AVG}}</div>
<div class="summary-label">√çndice de Inmunidad Digital (DII)</div>
</div>
<div class="summary-item">
<div class="summary-number" style="color: #4CAF50;">{{ATTACKS_WEEK}}</div>
<div class="summary-label">Incidentes Analizados</div>
</div>
<div class="summary-item">
<div class="summary-number" style="color: #C10016;">{{CRITICAL_PCT}}</div>
<div class="summary-label">Con Inmunidad Cr√≠tica</div>
</div>
<div class="summary-item">
<div class="summary-number" style="color: #FFB84D;">{{TOP_SECTOR}}</div>
<div class="summary-label">Sector M√°s Afectado</div>
</div>
</div>
<div class="summary-action">
<strong>{{KEY_INSIGHT}}</strong>
</div>
</div>

<!-- Header -->
<div class="header">
<h1>Dashboard de Inmunidad Digital: LATAM & Espa√±a</h1>
<div class="header-date">An√°lisis Semanal: {{WEEK_DATE}} | Framework DII 4.0</div>
</div>

<!-- Framework Context -->
<div class="framework-context">
<h4>üîç Digital Immunity Index (DII) 4.0</h4>
<p>DII es un innovador √≠ndice que mide su capacidad de prevenci√≥n y resiliencia ante ciberataques por medio de 5 indicadores relacionados con la digitalizaci√≥n de su modelo de negocio</p>
<p>Basado en la f√≥rmula: DII = (TRD √ó AER) / (HFP √ó BRI √ó RRG)</p>
<a href="https://percevals.github.io/Laberit-intelligence/immunity-framework.html" target="_blank">
Ver metodolog√≠a completa ‚Üí
</a>
</div>

<!-- DII Analysis Section -->
<div class="dii-analysis">
<h3 style="text-align: center; color: #B4B5DF; margin-bottom: 20px;">An√°lisis del √çndice de Inmunidad Digital</h3>
<div class="dii-scale">
<div class="dii-scale-bar">
<div class="dii-pointer" style="left: {{DII_POINTER_POSITION}}%;"></div>
</div>
<div class="dii-scale-labels">
<span>0</span>
<span>2.5</span>
<span>5</span>
<span>7.5</span>
<span>10</span>
</div>
<div class="dii-maturity-info" id="maturityInfo">
<h4 id="maturityTitle">Mueve el cursor sobre la escala para ver los modelos de madurez</h4>
<p id="maturityDesc"></p>
</div>
</div>
<div class="dii-components">
<div class="dii-component">
<div class="dii-component-value">{{AVG_TRD}}h</div>
<div class="dii-component-label">TRD - Tiempo hasta Degradaci√≥n</div>
</div>
<div class="dii-component">
<div class="dii-component-value">{{AVG_AER}}</div>
<div class="dii-component-label">AER - Eficiencia Adaptativa</div>
</div>
<div class="dii-component">
<div class="dii-component-value">{{AVG_HFP}}</div>
<div class="dii-component-label">HFP - Factor Humano</div>
</div>
<div class="dii-component">
<div class="dii-component-value">{{AVG_BRI}}</div>
<div class="dii-component-label">BRI - √çndice de Riesgo</div>
</div>
<div class="dii-component">
<div class="dii-component-value">{{AVG_RRG}}</div>
<div class="dii-component-label">RRG - Grado Regulatorio</div>
</div>
</div>
<div class="dii-formula">
DII = ({{AVG_TRD}} √ó {{AVG_AER}}) / ({{AVG_HFP}} √ó {{AVG_BRI}} √ó {{AVG_RRG}}) = {{DII_AVG}}
</div>
</div>

<!-- Business Model Distribution -->
<div class="model-distribution">
<h3 style="text-align: center; color: #B4B5DF; margin-bottom: 20px;">Distribuci√≥n por Modelo de Negocio</h3>
<div class="model-grid">
{{BUSINESS_MODEL_DISTRIBUTION}}
</div>
</div>

<!-- Key Metrics -->
<h2 style="text-align: center; margin-bottom: 20px; color: #B4B5DF;">M√©tricas Clave de la Semana</h2>

<div class="metrics-grid">
<div class="metric-card">
<div class="traffic-light {{DII_COLOR}}"></div>
<span class="metric-number">{{DII_AVG}}</span>
<span class="metric-label">√çndice DII Regional</span>
<span class="metric-context">{{DII_INTERPRETATION}}</span>
</div>
<div class="metric-card">
<div class="traffic-light {{TREND_COLOR}}"></div>
<span class="metric-number">{{TREND_DIRECTION}}</span>
<span class="metric-label">Tendencia Semanal</span>
<span class="metric-context">{{TREND_CONTEXT}}</span>
</div>
<div class="metric-card">
<div class="traffic-light {{SECTOR_COLOR}}"></div>
<span class="metric-number">{{WORST_SECTOR_DII}}</span>
<span class="metric-label">{{WORST_SECTOR}} - Menor DII</span>
<span class="metric-context">Requiere atenci√≥n inmediata</span>
</div>
<div class="metric-card">
<div class="traffic-light red"></div>
<span class="metric-number">{{PRIMARY_VECTOR}}</span>
<span class="metric-label">Vector Principal</span>
<span class="metric-context">{{VECTOR_INCIDENTS}} incidentes esta semana</span>
</div>
</div>

<!-- Chart Section -->
<div class="chart-container">
<h3 class="chart-title">Posicionamiento de Sectores por √çndice DII</h3>
<div class="chart-wrapper">
<div class="y-axis-label">‚Üì Menor Capacidad Operativa | Mayor Capacidad Operativa ‚Üë</div>
<div class="scatter-chart">
<!-- Quadrants -->
<div class="chart-quadrant" style="top: 0; left: 0; background: linear-gradient(135deg, rgba(76, 175, 80, 0.15), rgba(76, 175, 80, 0.1));">
<div>
<div class="chart-quadrant-title">RESILIENTES</div>
DII > 10<br>Operan efectivamente<br><small style="font-size: 11px; opacity: 0.7;">bajo ataque activo</small>
</div>
</div>
<div class="chart-quadrant" style="top: 0; right: 0; background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.15));">
<div>
<div class="chart-quadrant-title">FUNCIONALES</div>
DII 5-10<br>Degradaci√≥n limitada<br><small style="font-size: 11px; opacity: 0.7;">Recuperaci√≥n r√°pida</small>
</div>
</div>
<div class="chart-quadrant" style="bottom: 0; left: 0; background: linear-gradient(135deg, rgba(255, 184, 77, 0.15), rgba(255, 184, 77, 0.1));">
<div>
<div class="chart-quadrant-title">VULNERABLES</div>
DII 2-5<br>Impacto moderado<br><small style="font-size: 11px; opacity: 0.7;">Recuperaci√≥n lenta</small>
</div>
</div>
<div class="chart-quadrant" style="bottom: 0; right: 0; background: linear-gradient(135deg, rgba(193, 0, 22, 0.1), rgba(193, 0, 22, 0.2));">
<div>
<div class="chart-quadrant-title">CR√çTICOS</div>
DII < 2<br>Cese de operaciones<br><small style="font-size: 11px; opacity: 0.7;">bajo ataque</small>
</div>
</div>
{{DII_CHART_POINTS}}
</div>
<div class="x-axis-label">‚Üê Menor Exposici√≥n al Riesgo | Mayor Exposici√≥n al Riesgo ‚Üí</div>
</div>
</div>

<!-- Weekly Incidents -->
<div class="incidents-section">
<h2 style="text-align: center; margin-bottom: 20px; color: #B4B5DF;">Incidentes Analizados - {{WEEK_DATE}}</h2>
{{INCIDENTS_HTML}}
</div>

<!-- Threat Intelligence -->
<h2 style="text-align: center; margin: 40px 0 20px 0; color: #B4B5DF;">Inteligencia de Amenazas</h2>

<div class="threat-grid">
{{THREAT_ACTORS_CARD}}
{{ATTACK_VECTORS_CARD}}
{{AFFECTED_SECTORS_CARD}}
</div>

<!-- Action Plan -->
<h2 style="text-align: center; margin: 40px 0 20px 0; color: #B4B5DF;">Recomendaciones por Nivel DII</h2>

<div class="actions-grid">
{{ACTION_CARDS}}
</div>

<!-- Footer -->
<div class="footer">
<div class="footer-quote">"La inmunidad digital no previene ataques, permite operar mientras ocurren"</div>
<div>Framework DII 4.0 - Resiliencia Operacional Medible</div>
<div class="report-meta">
{{REPORT_METADATA}}
</div>
</div>
</div>

<!-- Detail Panel -->
<div class="detail-panel" id="detailPanel">
<button class="detail-close" onclick="closeDetail()">‚úï Cerrar</button>
<div id="detailContent"></div>
</div>

<!-- News Ticker -->
<div class="news-ticker">
<div class="ticker-content">
<strong>ALERTA SEMANAL:</strong>
<span id="tickerVictim">{{TICKER_NEWS}}</span>
</div>
<div>
<span class="ticker-source" id="tickerSource">{{TICKER_SOURCE}}</span> |
<span class="ticker-action" onclick="showVictimDetail()">Ver an√°lisis</span>
</div>
</div>

<script>
// Incident data with DII scores
const incidents = {{NEWS_DATA}};

let currentIncident = 0;

// Detail content database - Updated for DII 4.0
const detailContent = {
metric: {
dii: '<h4>√çndice de Inmunidad Digital (DII)</h4><p>El DII promedio regional de {{DII_AVG}} indica {{DII_INTERPRETATION}}. Los sectores con DII < 2 cesar√°n operaciones bajo ataque, mientras que aquellos con DII > 10 mantendr√°n funcionalidad operativa.</p>',
trend: '<h4>An√°lisis de Tendencia</h4><p>La tendencia {{TREND_DIRECTION}} refleja cambios en la preparaci√≥n operacional. Factores clave: evoluci√≥n de amenazas, inversi√≥n en resiliencia, y madurez de procesos.</p>',
sector: '<h4>{{WORST_SECTOR}}: Sector Cr√≠tico</h4><p>Con DII de {{WORST_SECTOR_DII}}, este sector muestra la menor capacidad de mantener operaciones bajo ataque. Principales brechas: {{SECTOR_GAPS}}.</p>'
},
threat: {
ransomware: '<h4>Ransomware: Vector Dominante</h4><p>Los ataques de ransomware afectan principalmente a organizaciones con DII < 3. El tiempo promedio hasta degradaci√≥n operativa (TRD) es de 4-12 horas.</p>',
supply_chain: '<h4>Cadena de Suministro: Riesgo Sist√©mico</h4><p>Los ataques a proveedores tecnol√≥gicos tienen efecto cascada. Organizaciones con modelo "Cadena de Suministro" requieren DII > 5 para resiliencia efectiva.</p>',
insider: '<h4>Amenaza Interna: Factor Humano</h4><p>El HFP (Human Failure Probability) promedio de 0.3-0.5 indica vulnerabilidad significativa. Programas de concientizaci√≥n pueden reducir el HFP en 40%.</p>'
},
model: {
regulated: '<h4>Informaci√≥n Regulada: Alta Exigencia</h4><p>Modelo con RRG m√°s alto (5). Requiere DII > 8 para cumplimiento operacional continuo. Sectores: Salud, Finanzas.</p>',
infrastructure: '<h4>Infraestructura Heredada: Deuda T√©cnica</h4><p>Sistemas legacy reducen AER (Adaptive Efficiency Ratio). Modernizaci√≥n gradual puede aumentar DII en 2-3 puntos.</p>',
financial: '<h4>Servicios Financieros: Balance Cr√≠tico</h4><p>Alto BRI (Business Risk Index) y RRG. Requiere inversi√≥n continua en resiliencia operacional para mantener DII > 5.</p>'
}
};

// Show detail panel
function showDetail(type, subtype) {
const content = detailContent[type]?.[subtype] || '<p>Informaci√≥n adicional no disponible.</p>';
document.getElementById('detailContent').innerHTML = content;
document.getElementById('detailPanel').classList.add('show');
}

// Close detail panel
function closeDetail() {
document.getElementById('detailPanel').classList.remove('show');
}

// Update ticker
function updateTicker() {
if (incidents && incidents.length > 0) {
currentIncident = (currentIncident + 1) % incidents.length;
const incident = incidents[currentIncident];
document.getElementById('tickerVictim').textContent = incident.title || incident.name;
document.getElementById('tickerSource').textContent = `DII: ${incident.dii || 'N/A'}`;
}
}

// Show victim detail
function showVictimDetail() {
if (incidents && incidents.length > 0) {
const incident = incidents[currentIncident];
document.getElementById('detailContent').innerHTML = `
<h4 style="color: #B4B5DF; margin-bottom: 15px;">${incident.title || 'An√°lisis del Incidente'}</h4>
<p style="line-height: 1.6;">${incident.description || incident.details || 'Sin detalles disponibles'}</p>
<div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.2); border-radius: 6px;">
<strong>DII:</strong> ${incident.dii || 'N/A'} | 
<strong>Modelo:</strong> ${incident.model || 'N/A'} | 
<strong>Vector:</strong> ${incident.vector || 'N/A'}
</div>
`;
document.getElementById('detailPanel').classList.add('show');
}
}

// Maturity models for DII scale
const maturityModels = {
  fragil: {
    range: [0, 2.5],
    title: 'Fr√°gil (DII 0-2.5)',
    description: 'Operaciones cesan completamente bajo ataque. Sin capacidad de resiliencia operacional. Recuperaci√≥n manual prolongada (d√≠as/semanas). P√©rdida total de ingresos durante incidentes.',
    class: 'maturity-fragil'
  },
  robusto: {
    range: [2.5, 5],
    title: 'Robusto (DII 2.5-5)',
    description: 'Degradaci√≥n significativa pero mantiene funciones cr√≠ticas. Recuperaci√≥n parcialmente automatizada (horas/d√≠as). P√©rdida de 50-80% de capacidad operativa.',
    class: 'maturity-robusto'
  },
  resiliente: {
    range: [5, 7.5],
    title: 'Resiliente (DII 5-7.5)',
    description: 'Mantiene operaciones esenciales con degradaci√≥n limitada. Recuperaci√≥n automatizada en horas. P√©rdida menor al 30% de capacidad. Procesos alternativos activos.',
    class: 'maturity-resiliente'
  },
  adaptativo: {
    range: [7.5, 10],
    title: 'Adaptativo (DII 7.5-10)',
    description: 'Opera efectivamente durante ataques activos. Auto-recuperaci√≥n en minutos. M√≠nima p√©rdida de capacidad (<10%). Aprende y mejora de cada incidente.',
    class: 'maturity-adaptativo'
  }
};

// Handle DII scale interaction
function updateMaturityInfo(diiValue) {
  const maturityInfo = document.getElementById('maturityInfo');
  const maturityTitle = document.getElementById('maturityTitle');
  const maturityDesc = document.getElementById('maturityDesc');
  
  // Find which maturity model applies
  let selectedModel = null;
  for (const [key, model] of Object.entries(maturityModels)) {
    if (diiValue >= model.range[0] && diiValue <= model.range[1]) {
      selectedModel = model;
      break;
    }
  }
  
  if (selectedModel) {
    maturityTitle.textContent = selectedModel.title;
    maturityDesc.textContent = selectedModel.description;
    
    // Update styling
    maturityInfo.className = 'dii-maturity-info ' + selectedModel.class;
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
// Add DII scale interaction
const diiScaleBar = document.querySelector('.dii-scale-bar');
const diiPointer = document.querySelector('.dii-pointer');

if (diiScaleBar) {
  // Handle mouse movement over scale
  diiScaleBar.addEventListener('mousemove', function(e) {
    const rect = this.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const percentage = (x / rect.width) * 100;
    const diiValue = (percentage / 100) * 10; // Convert to 0-10 scale
    
    updateMaturityInfo(diiValue);
  });
  
  // Handle mouse leave
  diiScaleBar.addEventListener('mouseleave', function() {
    // Reset to current DII value
    const currentPosition = parseFloat(diiPointer.style.left) || 0;
    const currentDII = (currentPosition / 100) * 10;
    updateMaturityInfo(currentDII);
  });
  
  // Initialize with current DII value
  const initialPosition = parseFloat(diiPointer.style.left) || 0;
  const initialDII = (initialPosition / 100) * 10;
  updateMaturityInfo(initialDII);
}

// Add click handlers to metric cards
document.querySelectorAll('.metric-card').forEach((card, index) => {
const types = ['dii', 'trend', 'sector', 'vector'];
card.addEventListener('click', () => showDetail('metric', types[index] || 'dii'));
});

// Add click handlers to incident cards
document.querySelectorAll('.incident-card').forEach(card => {
card.addEventListener('click', function() {
const title = this.querySelector('h3').textContent;
const dii = this.querySelector('.severity-badge').textContent;
document.getElementById('detailContent').innerHTML = `
<h4 style="color: #B4B5DF;">${title}</h4>
<p>${this.querySelector('p').textContent}</p>
<div style="margin-top: 15px;">
<strong>An√°lisis DII:</strong> ${dii}
</div>
`;
document.getElementById('detailPanel').classList.add('show');
});
});

// Add click handlers to threat cards
document.querySelectorAll('.threat-card').forEach(card => {
  card.style.cursor = 'pointer';
  card.addEventListener('click', function() {
    const title = this.querySelector('.threat-title').textContent;
    let detailType = 'ransomware';
    
    if (title.includes('Grupos Activos')) {
      detailType = 'ransomware';
    } else if (title.includes('Vectores de Ataque')) {
      detailType = 'supply_chain';
    } else if (title.includes('Sectores Afectados')) {
      detailType = 'regulated';
    }
    
    showDetail('threat', detailType);
  });
  
  // Add hover effect
  card.addEventListener('mouseenter', function() {
    this.style.transform = 'translateY(-2px)';
    this.style.borderColor = 'rgba(180, 181, 223, 0.4)';
  });
  
  card.addEventListener('mouseleave', function() {
    this.style.transform = '';
    this.style.borderColor = '';
  });
});

// Add click handlers to threat list items for more specific details
document.querySelectorAll('.threat-list li').forEach(item => {
  item.addEventListener('click', function(e) {
    e.stopPropagation(); // Prevent card click
    const threatName = this.querySelector('.threat-name span:first-child').textContent;
    const threatValue = this.querySelector('.threat-value').textContent;
    const threatSource = this.querySelector('.threat-source')?.textContent || '';
    
    let content = `<h4 style="color: #B4B5DF;">${threatName}</h4>`;
    content += `<p style="margin: 15px 0;"><strong>${threatValue}</strong></p>`;
    
    // Add specific content based on threat type
    if (threatName.includes('Ransomware')) {
      content += '<p>Los grupos de ransomware han evolucionado sus t√°cticas, ahora utilizan:</p>';
      content += '<ul style="margin: 10px 0; padding-left: 20px;">';
      content += '<li>Doble extorsi√≥n: cifrado + filtraci√≥n de datos</li>';
      content += '<li>Ataques dirigidos a infraestructura cr√≠tica</li>';
      content += '<li>Per√≠odos de inactividad antes del cifrado (dwelling time)</li>';
      content += '<li>Exfiltraci√≥n selectiva de datos sensibles</li>';
      content += '</ul>';
      content += '<p style="margin-top: 15px;"><strong>Recomendaci√≥n:</strong> Implementar EDR, backups offline, y simulacros de recuperaci√≥n semanales.</p>';
    } else if (threatName.includes('Supply Chain') || threatName.includes('Cadena')) {
      content += '<p>Los ataques a la cadena de suministro representan el mayor riesgo sist√©mico:</p>';
      content += '<ul style="margin: 10px 0; padding-left: 20px;">';
      content += '<li>Un proveedor comprometido puede afectar cientos de empresas</li>';
      content += '<li>Dif√≠ciles de detectar: c√≥digo malicioso en actualizaciones leg√≠timas</li>';
      content += '<li>Requieren evaluaci√≥n continua de terceros</li>';
      content += '</ul>';
      content += '<p style="margin-top: 15px;"><strong>Mitigaci√≥n:</strong> Auditor√≠as de seguridad a proveedores, SBOM (Software Bill of Materials), y ambientes de prueba aislados.</p>';
    } else if (threatSource) {
      content += `<p>${threatSource}</p>`;
      content += '<p style="margin-top: 15px;">An√°lisis detallado disponible en el reporte completo.</p>';
    }
    
    document.getElementById('detailContent').innerHTML = content;
    document.getElementById('detailPanel').classList.add('show');
  });
});

// Start ticker rotation
if (incidents && incidents.length > 0) {
setInterval(updateTicker, 8000);
}
});
</script>
</body>
</html>