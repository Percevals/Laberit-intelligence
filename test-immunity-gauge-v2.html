<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test ImmunityGaugeV2 - Working Implementation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: #f5f5f7;
            padding: 40px 20px;
            margin: 0;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #1d1d1f;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            font-size: 18px;
            margin-bottom: 50px;
        }
        .main-demo {
            background: white;
            padding: 60px;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            text-align: center;
            margin-bottom: 40px;
        }
        .main-demo.success {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 2px solid #4caf50;
        }
        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        .example-card {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            text-align: center;
        }
        h2 {
            margin: 0 0 40px 0;
            color: #333;
            font-size: 28px;
        }
        h3 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 18px;
        }
        .implementation-box {
            background: #e3f2fd;
            padding: 30px;
            border-radius: 16px;
            margin-top: 20px;
            text-align: left;
        }
        code {
            background: #1d1d1f;
            color: #fff;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .success-badge {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ImmunityGaugeV2 - Final Working Implementation</h1>
        <p class="subtitle">The arc gauge with 170° rotation and correct color progression</p>
        
        <!-- Main demonstration -->
        <div class="main-demo success">
            <h2>✅ ImmunityGaugeV2 with 170° Rotation</h2>
            
            <svg width="400" height="400" viewBox="0 0 400 400" style="transform: rotate(170deg);">
                <defs>
                    <!-- Gradient with reversed colors for 170° rotation -->
                    <linearGradient id="mainGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#3b82f6" />
                        <stop offset="33%" style="stop-color:#10b981" />
                        <stop offset="66%" style="stop-color:#f59e0b" />
                        <stop offset="100%" style="stop-color:#ef4444" />
                    </linearGradient>
                    <filter id="gaugeShadow" x="-50%" y="-50%" width="200%" height="200%">
                        <feDropShadow dx="0" dy="2" stdDeviation="3" floodOpacity="0.3"/>
                    </filter>
                </defs>
                
                <!-- Background arc (225° to 495°) -->
                <path d="M 100 300 A 140 140 0 1 1 300 300" 
                      fill="none" stroke="#e5e7eb" stroke-width="24" stroke-linecap="round" opacity="0.3" />
                
                <!-- Score arc (75% = 202.5°) -->
                <path d="M 100 300 A 140 140 0 1 1 263.6 329.2" 
                      fill="none" stroke="url(#mainGradient)" stroke-width="24" stroke-linecap="round" 
                      filter="url(#gaugeShadow)" />
                
                <!-- Counter-rotated center text -->
                <g transform="translate(200, 200) rotate(-170)">
                    <text text-anchor="middle" dominant-baseline="central" y="-8" 
                          font-size="56" font-weight="bold" fill="#1d1d1f">75</text>
                    <text text-anchor="middle" dominant-baseline="central" y="32" 
                          font-size="20" font-weight="500" fill="#10b981">RESILIENTE</text>
                    <text text-anchor="middle" dominant-baseline="central" y="52" 
                          font-size="14" fill="#666">95% confidence</text>
                </g>
            </svg>
            
            <div class="success-badge">WORKING CORRECTLY ✓</div>
            
            <div class="implementation-box">
                <h4 style="margin-top: 0;">Key Implementation Details:</h4>
                <ul style="line-height: 1.8;">
                    <li>Arc paths use fixed angles: 225° to 495° (270° sweep)</li>
                    <li>SVG rotated with CSS: <code>transform: rotate(170deg)</code></li>
                    <li>Gradient colors reversed because rotation > 90°</li>
                    <li>Text counter-rotated: <code>rotate(-170)</code></li>
                    <li>Result: Perfect alignment with correct color progression</li>
                </ul>
            </div>
        </div>

        <!-- Different score examples -->
        <h2 style="text-align: center; margin-top: 60px;">Score Examples with 170° Rotation</h2>
        <div class="examples-grid">
            <!-- 10% Score -->
            <div class="example-card">
                <h3>Low Score (10)</h3>
                <svg width="200" height="200" viewBox="0 0 200 200" style="transform: rotate(170deg);">
                    <defs>
                        <linearGradient id="grad10" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#3b82f6" />
                            <stop offset="33%" style="stop-color:#10b981" />
                            <stop offset="66%" style="stop-color:#f59e0b" />
                            <stop offset="100%" style="stop-color:#ef4444" />
                        </linearGradient>
                    </defs>
                    <path d="M 50 150 A 70 70 0 1 1 150 150" 
                          fill="none" stroke="#e5e7eb" stroke-width="12" stroke-linecap="round" opacity="0.3" />
                    <!-- 10% of 270° = 27° -->
                    <path d="M 50 150 A 70 70 0 0 1 68.9 143.2" 
                          fill="none" stroke="url(#grad10)" stroke-width="12" stroke-linecap="round" />
                    <g transform="translate(100, 100) rotate(-170)">
                        <text text-anchor="middle" dominant-baseline="central" 
                              font-size="32" font-weight="bold" fill="#ef4444">10</text>
                        <text text-anchor="middle" dominant-baseline="central" y="20" 
                              font-size="12" fill="#ef4444">FRÁGIL</text>
                    </g>
                </svg>
                <p style="margin-top: 15px; color: #666; font-size: 14px;">
                    Shows RED color (correct for low scores)
                </p>
            </div>

            <!-- 35% Score -->
            <div class="example-card">
                <h3>Medium Score (35)</h3>
                <svg width="200" height="200" viewBox="0 0 200 200" style="transform: rotate(170deg);">
                    <defs>
                        <linearGradient id="grad35" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#3b82f6" />
                            <stop offset="33%" style="stop-color:#10b981" />
                            <stop offset="66%" style="stop-color:#f59e0b" />
                            <stop offset="100%" style="stop-color:#ef4444" />
                        </linearGradient>
                    </defs>
                    <path d="M 50 150 A 70 70 0 1 1 150 150" 
                          fill="none" stroke="#e5e7eb" stroke-width="12" stroke-linecap="round" opacity="0.3" />
                    <!-- 35% of 270° = 94.5° -->
                    <path d="M 50 150 A 70 70 0 0 1 105.5 151.1" 
                          fill="none" stroke="url(#grad35)" stroke-width="12" stroke-linecap="round" />
                    <g transform="translate(100, 100) rotate(-170)">
                        <text text-anchor="middle" dominant-baseline="central" 
                              font-size="32" font-weight="bold" fill="#f59e0b">35</text>
                        <text text-anchor="middle" dominant-baseline="central" y="20" 
                              font-size="12" fill="#f59e0b">ROBUSTO</text>
                    </g>
                </svg>
                <p style="margin-top: 15px; color: #666; font-size: 14px;">
                    Shows ORANGE color (correct for medium scores)
                </p>
            </div>

            <!-- 65% Score -->
            <div class="example-card">
                <h3>Good Score (65)</h3>
                <svg width="200" height="200" viewBox="0 0 200 200" style="transform: rotate(170deg);">
                    <defs>
                        <linearGradient id="grad65" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#3b82f6" />
                            <stop offset="33%" style="stop-color:#10b981" />
                            <stop offset="66%" style="stop-color:#f59e0b" />
                            <stop offset="100%" style="stop-color:#ef4444" />
                        </linearGradient>
                    </defs>
                    <path d="M 50 150 A 70 70 0 1 1 150 150" 
                          fill="none" stroke="#e5e7eb" stroke-width="12" stroke-linecap="round" opacity="0.3" />
                    <!-- 65% of 270° = 175.5° -->
                    <path d="M 50 150 A 70 70 0 1 1 125.5 164.1" 
                          fill="none" stroke="url(#grad65)" stroke-width="12" stroke-linecap="round" />
                    <g transform="translate(100, 100) rotate(-170)">
                        <text text-anchor="middle" dominant-baseline="central" 
                              font-size="32" font-weight="bold" fill="#10b981">65</text>
                        <text text-anchor="middle" dominant-baseline="central" y="20" 
                              font-size="12" fill="#10b981">RESILIENTE</text>
                    </g>
                </svg>
                <p style="margin-top: 15px; color: #666; font-size: 14px;">
                    Shows GREEN color (correct for good scores)
                </p>
            </div>

            <!-- 90% Score -->
            <div class="example-card">
                <h3>Excellent Score (90)</h3>
                <svg width="200" height="200" viewBox="0 0 200 200" style="transform: rotate(170deg);">
                    <defs>
                        <linearGradient id="grad90" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#3b82f6" />
                            <stop offset="33%" style="stop-color:#10b981" />
                            <stop offset="66%" style="stop-color:#f59e0b" />
                            <stop offset="100%" style="stop-color:#ef4444" />
                        </linearGradient>
                    </defs>
                    <path d="M 50 150 A 70 70 0 1 1 150 150" 
                          fill="none" stroke="#e5e7eb" stroke-width="12" stroke-linecap="round" opacity="0.3" />
                    <!-- 90% of 270° = 243° -->
                    <path d="M 50 150 A 70 70 0 1 1 143.2 156.9" 
                          fill="none" stroke="url(#grad90)" stroke-width="12" stroke-linecap="round" />
                    <g transform="translate(100, 100) rotate(-170)">
                        <text text-anchor="middle" dominant-baseline="central" 
                              font-size="32" font-weight="bold" fill="#3b82f6">90</text>
                        <text text-anchor="middle" dominant-baseline="central" y="20" 
                              font-size="12" fill="#3b82f6">ADAPTATIVO</text>
                    </g>
                </svg>
                <p style="margin-top: 15px; color: #666; font-size: 14px;">
                    Shows BLUE color (correct for excellent scores)
                </p>
            </div>
        </div>

        <!-- React component usage -->
        <div style="background: #1d1d1f; color: #fff; padding: 40px; border-radius: 16px; margin-top: 60px;">
            <h2 style="color: #fff; text-align: center;">React Component Usage</h2>
            <pre style="margin: 20px auto; max-width: 700px; font-size: 16px; line-height: 1.6;">
// Import the fixed component
import { ImmunityGaugeV2 } from '@dii/visualizations';

// Use with 170° rotation
&lt;ImmunityGaugeV2
  score={{
    current: 75,
    previous: 65,
    stage: 'RESILIENTE',
    confidence: 95,
    percentile: 82,
    trend: 'improving'
  }}
  size="medium"
  showDetails={true}
  gaugeRotation={170}  // ← This triggers gradient reversal
/&gt;</pre>
        </div>

        <!-- Technical explanation -->
        <div style="background: #fff3e0; padding: 40px; border-radius: 16px; margin-top: 40px;">
            <h2 style="text-align: center;">🔧 Technical Implementation</h2>
            <div style="max-width: 800px; margin: 0 auto; line-height: 1.8;">
                <p><strong>The fix in ImmunityGaugeV2.tsx:</strong></p>
                <ol>
                    <li>Arc angles are <strong>fixed</strong> at 225° to 495° (not modified by rotation)</li>
                    <li>SVG is rotated using CSS transform</li>
                    <li>When <code>gaugeRotation > 90° && < 270°</code>, gradient colors are reversed</li>
                    <li>Text is counter-rotated to stay upright</li>
                </ol>
                <p style="margin-top: 20px;">
                    This ensures the grey background and colored progress arcs always align perfectly,
                    while maintaining the correct color progression from red (low) to blue (high).
                </p>
            </div>
        </div>
    </div>
</body>
</html>